<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>项目详情</title>
    <link rel="stylesheet" href="assets/layui/css/layui.css">
    <link rel="stylesheet" href="assets/style/admin.css">
    <link rel="stylesheet" href="assets/style/login.css">
    <style type="text/css">
        .layui-disabled,.layui-disabled:hover {
            color: black !important;
            cursor: not-allowed !important
        }
    </style>
</head>
<body>
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layadmin-user-login-main layui-card-body" style="padding: 15px;width: 38%;">
            <div class="layadmin-user-login-box layadmin-user-login-header">
                <h2>项目详情</h2>
            </div>
            <div class="layadmin-user-login-box layadmin-user-login-body">
                <form class="layui-form layui-form-pane" lay-filter="projectDetails">
                    <div class="layui-form-item">
                        <label class="layui-form-label">项目名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="name" lay-verify="name" autocomplete="off" readonly class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">申报级别</label>
                        <div class="layui-input-block">
                            <select name="level" lay-verify="required" disabled>
                                <option value="0">校级一类</option>
                                <option value="1">校级二类</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">负责人</label>
                        <div class="layui-input-block">
                            <input type="text" name="leader" id="leader" autocomplete="off" class="layui-input" readonly>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">手机号码</label>
                        <div class="layui-input-block">
                            <input type="tel" name="phone" lay-required="phone" autocomplete="off" class="layui-input" readonly>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">电子邮箱</label>
                        <div class="layui-input-block">
                            <input type="email" name="email" lay-required="email" autocomplete="off" class="layui-input" readonly>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">所属专业</label>
                        <div class="layui-input-block">
                            <select name="major" lay-verify="required" disabled style="color: #000;">
                                <option value="0">计算机科学与技术</option>
                                <option value="1">电子信息工程</option>
                                <option value="2">电子信息科学与技术</option>
                                <option value="3">数字媒体技术</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item" id="member-box">
                        <label class="layui-form-label">项目成员</label>
                        <div class="layui-input-block">
                            <input type="text" name="members" lay-required autocomplete="off" class="layui-input" readonly>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-upload">
                            <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                                <p style="font-size: medium; margin-bottom: 15px">立项承诺书</p>
                                <div id="img-box" align="center">
                                    <img id="commitment" width="500px">
                                </div>
                            </blockquote>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-row">
                            <div class="layui-col-xs10">
                                <label class="layui-form-label">申报书</label>
                                <div class="layui-input-block">
                                    <input type="text" id="filename" lay-required autocomplete="off" class="layui-input" disabled>
                                </div>
                            </div>
                            <div class="layui-col-xs2">
                                <div style="margin-left: 10px; float: right;">
                                    <a id="download"><input type="button" value="下载" class="layui-btn"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="assets/layui/layui.js"></script>
<script>
    function getUrlQueryString(names, urls) {
        urls = urls || window.location.href;
        urls && urls.indexOf("?") > -1 ? urls = urls
            .substring(urls.indexOf("?") + 1) : "";
        var reg = new RegExp("(^|&)" + names + "=([^&]*)(&|$)", "i");
        var r = urls ? urls.match(reg) : window.location.search.substr(1)
            .match(reg);
        if (r != null && r[2] !== "")
            return unescape(r[2]);
        return null;
    }

    layui.use(['jquery', 'form', 'layer'], function () {
        var $ = layui.$;
        var form = layui.form;
        var layer=layui.layer;
        $(document).ready(function(){
            $.ajax({
                type:'get'
                ,url: '/project/getDetails'
                ,data:'projectId='+getUrlQueryString('id')
                ,dataType:'json'
                ,success:function(data){
                    var members=JSON.parse(data.object.members);
                    var memberStr;
                    for (var i=0;i<members.length-1;i++){
                        memberStr+=members[0]+',';
                    }
                    memberStr+=members[members.length-1];
                    form.val('projectDetails',{
                        "name":data.object.name
                        ,"level":data.object.level
                        ,"leader":data.object.leader
                        ,"phone":data.object.phone
                        ,"email":data.object.email
                        ,"major":data.object.major
                        ,"members":members
                    });
                    $('#commitment').attr('src','/img/'+data.object.commitmentId);
                    $('#download').attr('href','/file/'+data.object.filepath+'/'+data.object.filename);
                    $('#filename').val(data.object.filename);
                }
            })
        })
    });
</script>
</body>
</html>
